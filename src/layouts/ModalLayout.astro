---
import Layout from './Layout.astro';

interface Props {
  title: string;
}

const { title } = Astro.props;
---

<Layout title={title}>
  <!-- Backdrop -->
  <div transition:name="page-bg" class="fixed inset-0 bg-[url(images/mountain-ranges-thumb.webp)] bg-cover z-40" />

  <!-- Modal container -->
  <div class="fixed inset-0 flex items-center justify-center p-4 z-50 pointer-events-none">
    <!-- Modal wrapper with flexbox layout -->
    <div class="modal-card flex flex-col bg-[#0d0d0d]/20 backdrop-blur-2xl border border-white/10 rounded-lg max-w-4xl w-full max-h-[90vh] md:max-h-[85vh] pointer-events-auto overflow-hidden">
      <!-- Modal header (outside overflow) -->
      <div class="bg-[#0d0d0d]/80 backdrop-blur border-b border-white/5 px-6 md:px-8 py-4 flex justify-between items-center flex-shrink-0">
        <h1 class="text-slate-100 font-light text-xl tracking-tight">
          {title}
        </h1>
        <a
          href="/"
          class="text-slate-400 hover:text-lituus-pink transition-colors shrink-0 text-2xl leading-none"
          aria-label="Close modal"
        >
          âœ•
        </a>
      </div>

      <!-- Modal content (scrollable) -->
      <div class="overflow-auto px-6 md:px-8 py-8">
        <slot />
      </div>
    </div>
  </div>

  <script>
    // Close modal on ESC key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        window.location.href = '/';
      }
    });

    // Close modal on backdrop click
    document.addEventListener('click', (e) => {
      if (e.target === e.currentTarget) {
        window.location.href = '/';
      }
    });

    // Prevent body scroll when modal is open
    document.body.style.overflow = 'hidden';

    // Re-enable scroll on page unload
    window.addEventListener('beforeunload', () => {
      document.body.style.overflow = '';
    });
  </script>

  <style>
    .modal-card {
      animation: modalEnter 0.4s ease-out both;
    }

    @keyframes modalEnter {
      from {
        opacity: 0;
        transform: scale(0.75);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
  </style>
</Layout>
